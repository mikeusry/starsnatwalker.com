---
import { generatePlayerSlug } from '../lib/slug';

interface Props {
  id: string;
  firstName: string;
  lastName: string;
  gradYear: number;
  position: string;
  secondaryPositions?: string[] | null;
  bats?: string | null;
  throws?: string | null;
  twitter?: string | null;
  photoUrl?: string | null;
  featured?: boolean;
}

const {
  id,
  firstName,
  lastName,
  gradYear,
  position,
  secondaryPositions,
  bats,
  throws,
  twitter,
  photoUrl,
  featured = false
} = Astro.props;

const positions = [position, ...(secondaryPositions || [])].filter(Boolean).join(' / ');
const handedness = bats && throws ? `${bats}/${throws}` : null;
const playerSlug = generatePlayerSlug(firstName, lastName);
---

<a
  href={`/players/${playerSlug}`}
  class:list={[
    "card group hover:shadow-xl transition-all duration-300 block",
    featured && "ring-2 ring-stars-blue"
  ]}
>
  <!-- Photo or Placeholder -->
  <div class="aspect-[4/5] bg-gradient-to-br from-stars-navy to-stars-navy-light relative overflow-hidden">
    {photoUrl ? (
      <img
        src={photoUrl}
        alt={`${firstName} ${lastName}`}
        class="w-full h-full object-cover"
      />
    ) : (
      <div class="w-full h-full flex items-center justify-center">
        <div class="text-center">
          <div class="text-6xl text-stars-blue/50 mb-2">★</div>
          <div class="text-white/30 font-bold text-lg">
            {firstName.charAt(0)}{lastName.charAt(0)}
          </div>
        </div>
      </div>
    )}

    <!-- Grad Year Badge -->
    <div class="absolute top-4 right-4 bg-stars-blue text-white font-bold text-sm px-3 py-1 rounded-full shadow-lg">
      {gradYear}
    </div>

    <!-- Featured Badge -->
    {featured && (
      <div class="absolute top-4 left-4 bg-stars-navy text-white text-xs font-semibold px-2 py-1 rounded-full shadow-lg">
        Featured
      </div>
    )}
  </div>

  <!-- Player Info -->
  <div class="p-5">
    <h3 class="font-bold text-lg text-gray-900 group-hover:text-stars-blue transition-colors">
      {firstName} {lastName}
    </h3>

    <div class="flex items-center gap-2 mt-1 text-sm text-gray-600">
      <span class="font-medium text-stars-navy">{positions}</span>
      {handedness && (
        <>
          <span class="text-gray-300">•</span>
          <span>{handedness}</span>
        </>
      )}
    </div>

    <!-- Actions -->
    <div class="flex items-center gap-3 mt-4 pt-4 border-t border-gray-100">
      <span class="flex-1 text-center text-sm font-medium text-stars-blue group-hover:opacity-75 transition-opacity">
        View Profile →
      </span>

      {twitter && (
        <span class="text-gray-400 group-hover:text-gray-600 transition-colors">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
          </svg>
        </span>
      )}
    </div>
  </div>
</a>
